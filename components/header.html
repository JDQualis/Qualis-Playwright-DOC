<header class="header">
  <div class="header-left">
    <a href="https://jdqualis.github.io/Qualis-Playwright-DOC/" target="_blank" rel="noopener noreferrer">
      <img src="./assets/logo.png" alt="Logo" class="logo" />
    </a>
  </div>

  <div class="header-center">
    <div class="search-box">
      <input 
        type="text" 
        id="search-input" 
        placeholder="Buscar en la documentación..." 
        class="search-input"
        autocomplete="off"
        spellcheck="false"
      />
      <div id="search-results" class="search-results"></div>
    </div>
  </div>

  <div class="header-right">
    <label class="toggle-switch">
      <input type="checkbox" id="theme-toggle" />
      <span class="slider"></span>
    </label>
  </div>
</header>

<head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

</head>

<script>
// Función de inicialización del header
window.initHeader = function() {
  // Datos de búsqueda simplificados
  const pages = [
    { title: 'Inicio', url: '#home', description: 'Página principal' },
    { title: 'Instalación', url: '#instalacion', description: 'Guía de instalación' },
    { title: 'Estructura', url: '#estructura', description: 'Estructura del proyecto' },
    { title: 'Pages y Locators', url: '#pages-locators', description: 'Implementación de Page Objects' },
    { title: 'Cucumber', url: '#cucumber', description: 'Tests con Cucumber' },
    { title: 'Ejecución', url: '#ejecucion', description: 'Ejecutar pruebas' },
    { title: 'Reportes', url: '#reportes', description: 'Ver reportes' },
    { title: 'Buenas Prácticas', url: '#buenas-practicas', description: 'Guía de buenas prácticas' }
  ];

  const searchInput = document.getElementById('search-input');
  const searchResults = document.getElementById('search-results');

  if (!searchInput || !searchResults) {
    console.error('Elementos de búsqueda no encontrados');
    return;
  }

  // Búsqueda simple
  searchInput.addEventListener('input', function(e) {
    const query = e.target.value.toLowerCase().trim();
    console.log('Búsqueda:', query); // Debug

    // Mostrar/ocultar resultados basado en la longitud de la búsqueda
    if (query.length < 2) {
      searchResults.style.display = 'none';
      return;
    }

    // Filtrar resultados
    const results = pages.filter(page => 
      page.title.toLowerCase().includes(query) || 
      page.description.toLowerCase().includes(query)
    );

    console.log('Resultados encontrados:', results.length); // Debug

    // Mostrar resultados
    if (results.length > 0) {
      const html = results.map(result => `
        <a href="${result.url}" class="search-result-item">
          <div class="result-title">${result.title}</div>
          <div class="result-description">${result.description}</div>
        </a>
      `).join('');
      
      searchResults.innerHTML = html;
      searchResults.style.display = 'block';
    } else {
      searchResults.innerHTML = '<div class="no-results">No se encontraron resultados</div>';
      searchResults.style.display = 'block';
    }
  });

  // Cerrar resultados al hacer clic fuera
  document.addEventListener('click', function(e) {
    if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
      searchResults.style.display = 'none';
    }
  });

  // Manejar clics en resultados
  searchResults.addEventListener('click', function(e) {
    const link = e.target.closest('a');
    if (link) {
      e.preventDefault();
      const page = link.getAttribute('href').replace('#', '');
      window.routeTo(page);
      searchInput.value = '';
      searchResults.style.display = 'none';
    }
  });

  // Tema oscuro/claro (manteniendo el switch original)
  const themeToggle = document.getElementById('theme-toggle');

  if (themeToggle) {
    themeToggle.addEventListener('change', function() {
      const isDark = this.checked;
      document.documentElement.classList.toggle('dark', isDark);
      document.documentElement.setAttribute('data-theme', isDark ? 'dark' : 'light');
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
    });

    // Inicializar tema
    const savedTheme = localStorage.getItem('theme') || 'dark';
    themeToggle.checked = savedTheme === 'dark';
    document.documentElement.classList.toggle('dark', savedTheme === 'dark');
    document.documentElement.setAttribute('data-theme', savedTheme);
  }
};

// Ejecutar la inicialización si el DOM ya está listo
if (document.readyState === 'complete' || document.readyState === 'interactive') {
  window.initHeader();
} else {
  document.addEventListener('DOMContentLoaded', window.initHeader);
}
</script>
